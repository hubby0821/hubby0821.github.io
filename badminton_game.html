<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>羽球導覽互動挑戰</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 0;
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      height: 100vh; text-align: center;
    }
    .container {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 30px;
      border-radius: 15px;
      max-width: 700px;
      width: 90%;
    }
    h1 { font-size: 2em; margin-bottom: 20px; }
    .progress-label { margin-bottom: 5px; font-weight: bold; }
    .progress-container {
      width: 100%;
      background-color: #444;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .progress-bar {
      height: 20px;
      width: 0%;
      background-color: #4caf50;
      transition: width 0.3s;
    }
    .button-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    #quiz-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: #2196f3;
      color: white;
      cursor: pointer;
    }
    .hidden { display: none; }
    #completion-message {
      margin-top: 20px;
      color: #ffeb3b;
    }
    .completed-btn {
      background-color: #4caf50;
      cursor: default;
    }
  </style>
</head>
<body>
  <div class="container" id="main-screen">
    <h1>羽球導覽挑戰</h1>
    <div class="progress-label" id="progress-text">完成度：0%</div>
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="button-grid" id="venue-buttons"></div>

    <div id="completion-message" class="hidden">
      <h2>恭喜你完成所有挑戰！</h2>
      <button onclick="resetProgress()">重新開始導覽</button>
    </div>
  </div>

  <!-- 題目畫面 -->
  <div class="container hidden" id="quiz-screen">
    <h1 id="quiz-question">題目文字</h1>
    <div id="quiz-options"></div>
  </div>

  <script>
    const questions = [
      { question: "羽球正式比賽採用幾分制？", options: ["21分制", "15分制", "11分制", "30分制"], answer: 0 },
      { question: "發球時，發球員應站在哪一側？", options: ["左邊", "右邊", "中間", "後場"], answer: 1 },
      { question: "國際羽聯的英文縮寫是？", options: ["BWF", "FWB", "WFB", "IBF"], answer: 0 },
      { question: "羽球拍的拍面通常使用什麼材質？", options: ["金屬線", "尼龍線", "棉線", "碳纖線"], answer: 1 },
      { question: "羽球最高速度紀錄大約是多少？", options: ["超過200公里/小時", "超過300公里/小時", "超過400公里/小時", "超過500公里/小時"], answer: 2 },
      { question: "羽球比賽一局最多可打到幾分？", options: ["21分", "25分", "29分", "30分"], answer: 3 },
      { question: "羽球比賽通常幾局幾勝？", options: ["三局兩勝", "五局三勝", "七局四勝", "一局定勝負"], answer: 0 },
      { question: "羽球的英文是什麼？", options: ["Badminton", "Basketball", "Baseball", "Ping Pong"], answer: 0 },
      { question: "以下哪一項不是羽球場地的界線？", options: ["底線", "邊線", "中線", "斜線"], answer: 3 },
      { question: "羽球的重量大約是多少？", options: ["4-5克", "10-12克", "16-18克", "20-25克"], answer: 2 },
      { question: "羽球拍主要由什麼材質製成？", options: ["鋁", "木頭", "碳纖維", "塑膠"], answer: 2 },
      { question: "哪個國家不是羽球強國？", options: ["中國", "印尼", "丹麥", "美國"], answer: 3 },
      { question: "混雙比賽中哪個性別通常接第一個發球？", options: ["男生", "女生", "不一定", "由裁判決定"], answer: 2 },
      { question: "羽球比賽時能否踩到發球線？", options: ["可以", "不可以", "只有單打可以", "只有雙打可以"], answer: 1 },
      { question: "羽球比賽中何時交換場地？", options: ["每局中間", "每局結束", "一場比賽結束", "從不交換"], answer: 1 }
    ];

    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    function showGame(index) {
      const q = questions[index - 1];
      document.getElementById('main-screen').classList.add('hidden');
      document.getElementById('quiz-screen').classList.remove('hidden');
      document.getElementById('quiz-question').innerText = q.question;

      const optionsDiv = document.getElementById('quiz-options');
      optionsDiv.innerHTML = "";
      q.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.innerText = opt;
        btn.onclick = () => {
          if (localStorage.getItem('game' + index) === 'true') {
            alert("你已完成這題，回到主頁！");
            goBackToMain();
            return;
          }
          if (i === q.answer) {
            alert("答對了！");
            localStorage.setItem('game' + index, 'true');
            goBackToMain();
          } else {
            alert("答錯了，再試一次！");
          }
        };
        optionsDiv.appendChild(btn);
      });
    }

    function goBackToMain() {
      document.getElementById('quiz-screen').classList.add('hidden');
      document.getElementById('main-screen').classList.remove('hidden');
      updateProgress();
    }

    function updateProgress() {
      const venueDiv = document.getElementById('venue-buttons');
      venueDiv.innerHTML = "";
      let completed = 0;
      for (let i = 1; i <= questions.length; i++) {
        const btn = document.createElement("button");
        if (localStorage.getItem('game' + i) === 'true') {
          completed++;
          btn.innerText = `題目 ${i} - 已完成`;
          btn.classList.add('completed-btn');
        } else {
          btn.innerText = `挑戰題目 ${i}`;
        }
        btn.onclick = () => showGame(i);
        venueDiv.appendChild(btn);
      }
      const percentage = Math.round((completed / questions.length) * 100);
      document.getElementById('progress-bar').style.width = percentage + '%';
      document.getElementById('progress-text').innerText = '完成度：' + percentage + '%';
      if (completed === questions.length) {
        document.getElementById('completion-message').classList.remove('hidden');
      } else {
        document.getElementById('completion-message').classList.add('hidden');
      }
    }

    function resetProgress() {
      localStorage.clear();
      updateProgress();
      document.getElementById('completion-message').classList.add('hidden');
      document.getElementById('main-screen').classList.remove('hidden');
      document.getElementById('quiz-screen').classList.add('hidden');
    }

    window.onload = function () {
      const questionIndex = getQueryParam('question');
      if (questionIndex) {
        showGame(parseInt(questionIndex));
      } else {
        updateProgress();
      }
    };
  </script>
</body>
</html>
